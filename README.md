# **Life or Business**

![Python](https://img.shields.io/badge/Python-3.9.11-blue?style=for-the-badge&logo=python&logoColor=blue)

# **Содержание**
**1. Цели проекта**  
**2. Требования проекта**  
**3. Краткая информация о данных**   
**4. Этапы реализации проекта**   
**5. Результаты**  
**6. Ссылки на результаты**

---
## **1. Цели проекта**

1.1. Наличие ML-модели, способной различать русскоязычные Business и Life Instagram-аккаунты;

1.2. Telegram-бот, способный различать Business и Life Instagram-аккаунты посредством использования построенной модели из п. 1.1;

---
##  **2. Требования проекта**

2.1. Качество модели должно измеряться метрикой f1 score и быть не ниже 0.94 на тестовой выборке размером 25% от имеющейся;

2.2. Модель должна давать на тестовой выборке размером 25% от имеющейся значение метрики presicion не ниже 0.95;

2.3. Telegram-бот должен функионировать на удаленном сервере;

2.4. Время ответа Telegram-бота на запрос предсказания метки для одного аккаунта должно быть не более 10 секунд.

---
## **3. Краткая информация о данных**
Данные имеют вид таблицы с размерностью 2534х18.  
Расшифровка признаков данных:

3.1. user_name - логин пользователя (str);  
3.2. is_business - наличие метки Business-аккаунта (bin);  
3.3. is_private - является ли аккаунт закрытым (bin);  
3.4. post_captions - подписи к первым 10 постам, включая хештеги (str);  
3.5. likes4post - среднее лайков хештегов в первых N постах (float);  
3.6. comms4post - среднее комментраиев хештегов в первых N 3.постах (float);  
3.7. hashtags4post - среднее количество хештегов в первых N постах (float);  
3.8. lenth_title4post - среднее количество слов в подписи к первым N постам (float);  
3.9. publications_period - средний период между публикацией каждого из первых 10 постов в часах (float);  
3.10. count_posts - количество постов (int);  
3.11. count_followers - количество подписчиков (int);  
3.12. count_followees - количество подписок (int);  
3.13. count_igtv - количество igtv (int);  
3.14. is_verified - верифицирован ли аккаунт (bin);  
3.15. biography - биография аккаунта (str);   
3.16. full_name - полное имя аккаунта (str);  
3.17. business_category - категория Business-аккаунта (при наличии соответствующей метки) (str);  
3.18. target - целевая переменная, является ли аккаунт Business-аккаунтом (bin);

---
## **4. Этапы реализации проекта**
В каждом из этапов реализации перечислены основные действия, которые были осуществлены (более подробные выводы на каждом этапе и другая полезная информация представлены в jupyter notebooks info_loader.ipynb (п. 6.1.) и insta_business_or_not (п. 6.2.)):

4.1. Парсинг данных (согласно п.3) в количестве не менее 2500 наблюдений посредством библиотеки Instaloader (п.6.3.). Наблюдения (аккаунты) выбраны из подписок 6-ти аккаунтов. Target-метка была выставлена самостоятельно на основе визуального анализа аккаунта;

4.2. Анализ спарсенных данных:  
    
* 4.2.1. Построены графики. Виды используемых графиков: countplot, boxplot, pieplot, correlation-matrix; 

* 4.2.2. В ходе анализа признак is_verified был удален из-за критического дисбаланса значений;

* 4.2.3. Значения признака business_category, которые повторяются менее 10 раз в выборке, были отнесены к одному значению 'Other';

*  4.2.4. Признак business_category был разделен на отдельные признаки посредством OneHotEncoding;

4.3. Преобразование текстовых данных. Текстовые данные были токенизированы и трансформированы с помощью TFIDF векторайзера.

4.4. Тренировка моделей:

* 4.4.1. Были обучены 2 модели: Random Forest и XGBoost.

* 4.4.2. В качестве финальной модели была выбрана XGBoost-модель.

4.5. Написан Telegram-бот с помощью библиотеки aiogram.

4.6. Telegram-бот установлен на удаленный сервер в сервисе Heroku.

---
## **5. Результаты**  

5.1. Цели проекта достигнуты  

* 5.1.1. Имеется XGBoost-модель, разделяющая русскоязычные Instargam-аккаунты на Business- и Life-аккаунты insta_model.sav (п. 6.4.);
* 5.1.2. Имеется Telegram-бот, способный различать Business и Life Instagram-аккаунты с помощью модели из п. 5.1.1. (п. 6.5.)

5.2. Требования выполнены:

* 5.2.1. F1-score модели на отложенной выборке составил 0.9448
* 5.2.2. Presicion score на отложенной выборке составил 0.9586
* 5.2.3. Telegram-бот удаленно функционирует на сервисе Heroku
* 5.2.4. Telegram bot отвечает на запрос менее чем за 10 секунд (в среднем за 5 секунд)
---
## **6. Ссылки на результаты**
6.1. Jypiter Notebook с парсингом [info_loader.ipynb](https://github.com/VladimirLakhtin/insta_pred/blob/master/parsing/info_loader.ipynb)  
6.2. Jypiter Notebook с анализом данных и тренировкой моделей [insta_business_or_not.ipynb](https://github.com/VladimirLakhtin/insta_pred/blob/master/insta_business_or_not.ipynb)  
6.3. Спарсенные данные [data.csv](https://github.com/VladimirLakhtin/insta_pred/tree/master/data)   
6.4.Финальная XGBoost-модель [insta_model.sav](https://github.com/VladimirLakhtin/insta_pred/blob/master/insta_pred_bot/prediction_part/model/insta_model.sav)  
6.5. Telegram-бот [@Instapred_MLBot](https://t.me/ML_isBusiness_Bot)


